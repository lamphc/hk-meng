{"version":3,"sources":["pages/Rent/Search/index.module.css","pages/Rent/Search/index.js"],"names":["module","exports","Search","state","searchTxt","tipsList","handlerSearch","v","a","async","trim","length","setState","getCommunity","cityId","res","status","data","selectCom","item","props","history","replace","id","community","name","communityName","renderTips","map","onClick","key","className","styles","tip","getCurrCity","value","this","root","placeholder","onChange","showCancelButton","onCancel","tips","Component"],"mappings":"sGACAA,EAAOC,QAAU,CAAC,KAAO,qBAAqB,KAAO,qBAAqB,UAAY,0BAA0B,KAAO,qBAAqB,IAAM,sB,wNCQ7HC,E,2MAEnBC,MAAQ,CAENC,UAAW,GACXC,SAAU,I,EAUZC,cAAgB,SAAOC,GAAP,eAAAC,EAAAC,OAAA,mDAEG,KADjBF,EAAIA,EAAEG,QACAC,OAFQ,yCAGL,EAAKC,SAAS,CACnBR,UAAW,GACXC,SAAU,MALA,cAQd,EAAKO,SAAS,CACZR,UAAWG,IATC,WAAAC,EAAA,MAYIK,YAAaN,EAAG,EAAKO,SAZzB,OAaK,OADbC,EAZQ,QAaNC,QACN,EAAKJ,SAAS,CACZP,SAAUU,EAAIE,OAfJ,sC,EAqBhBC,UAAY,SAACC,GACX,EAAKC,MAAMC,QAAQC,QAAQ,YAAa,CAAEC,GAAIJ,EAAKK,UAAWC,KAAMN,EAAKO,iB,EAI3EC,WAAa,WAGX,OAFqB,EAAKxB,MAAlBE,SAEQuB,KAAI,SAAAT,GAAI,OACtB,wBAAIU,QAAS,kBAAM,EAAKX,UAAUC,IAAOW,IAAKX,EAAKK,UAAWO,UAAWC,IAAOC,KAC7Ed,EAAKO,mB,uLApCcQ,e,gBAAhBC,E,EAAAA,MACRC,KAAKtB,OAASqB,E,gFAwCN,IACAd,EAAYe,KAAKhB,MAAjBC,QACAjB,EAAcgC,KAAKjC,MAAnBC,UAER,OACE,yBAAK2B,UAAWC,IAAOK,MAErB,uBACEC,YAAY,mDACZH,MAAO/B,EACPmC,SAAUH,KAAK9B,cACfkC,kBAAkB,EAClBC,SAAU,kBAAMpB,EAAQC,QAAQ,gBAIlC,wBAAIS,UAAWC,IAAOU,MAAON,KAAKT,mB,GAnENgB","file":"static/js/16.9ed80c12.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Search_root__1RO5f\",\"list\":\"Search_list__2aU3H\",\"noHistory\":\"Search_noHistory__1jsXM\",\"tips\":\"Search_tips__1_3KG\",\"tip\":\"Search_tip__V0T8K\"};","import React, { Component } from 'react'\r\n\r\nimport { SearchBar } from 'antd-mobile'\r\n\r\nimport { getCurrCity } from '../../../utils'\r\n\r\nimport styles from './index.module.css'\r\nimport { getCommunity } from '../../../utils/api/city'\r\n\r\nexport default class Search extends Component {\r\n\r\n  state = {\r\n    // 搜索框的值\r\n    searchTxt: '',\r\n    tipsList: []\r\n  }\r\n\r\n  async componentDidMount() {\r\n    // 获取城市ID\r\n    const { value } = await getCurrCity();\r\n    this.cityId = value;\r\n  }\r\n\r\n  // 搜索小区\r\n  handlerSearch = async (v) => {\r\n    v = v.trim();\r\n    if (v.length === 0) {\r\n      return this.setState({\r\n        searchTxt: '',\r\n        tipsList: []\r\n      })\r\n    }\r\n    this.setState({\r\n      searchTxt: v\r\n    })\r\n    // 获取小区列表\r\n    const res = await getCommunity(v, this.cityId);\r\n    if (res.status === 200) {\r\n      this.setState({\r\n        tipsList: res.data\r\n      })\r\n    }\r\n  }\r\n\r\n  // 选择小区回传\r\n  selectCom = (item) => {\r\n    this.props.history.replace('/rent/add', { id: item.community, name: item.communityName })\r\n  }\r\n\r\n  // 渲染搜索结果列表\r\n  renderTips = () => {\r\n    const { tipsList } = this.state\r\n\r\n    return tipsList.map(item => (\r\n      <li onClick={() => this.selectCom(item)} key={item.community} className={styles.tip}>\r\n        {item.communityName}\r\n      </li>\r\n    ))\r\n  }\r\n\r\n  render() {\r\n    const { history } = this.props\r\n    const { searchTxt } = this.state\r\n\r\n    return (\r\n      <div className={styles.root}>\r\n        {/* 搜索框 */}\r\n        <SearchBar\r\n          placeholder=\"请输入小区或地址\"\r\n          value={searchTxt}\r\n          onChange={this.handlerSearch}\r\n          showCancelButton={true}\r\n          onCancel={() => history.replace('/rent/add')}\r\n        />\r\n\r\n        {/* 搜索提示列表 */}\r\n        <ul className={styles.tips}>{this.renderTips()}</ul>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"],"sourceRoot":""}