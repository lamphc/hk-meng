{"version":3,"sources":["pages/Rent/Search/index.module.css","pages/Rent/Search/index.js"],"names":["module","exports","Search","state","searchTxt","tipsList","handlerSearch","v","trim","length","setState","timer","clearTimeout","setTimeout","a","async","getCommunity","cityId","res","status","data","selectCom","item","props","history","replace","pathname","id","community","name","communityName","renderTips","map","onClick","key","className","styles","tip","getCurrCity","value","this","root","placeholder","onChange","showCancelButton","onCancel","tips","Component"],"mappings":"sGACAA,EAAOC,QAAU,CAAC,KAAO,qBAAqB,KAAO,qBAAqB,UAAY,0BAA0B,KAAO,qBAAqB,IAAM,sB,wNCQ7HC,E,2MAEnBC,MAAQ,CAENC,UAAW,GACXC,SAAU,I,EAUZC,cAAgB,SAACC,GAEf,GAAiB,KADjBA,EAAIA,EAAEC,QACAC,OACJ,OAAO,EAAKC,SAAS,CACnBN,UAAW,GACXC,SAAU,KAGd,EAAKK,SAAS,CACZN,UAAWG,IACV,WACD,EAAKI,OAASC,aAAa,EAAKD,OAChC,EAAKA,MAAQE,YAAW,0BAAAC,EAAAC,OAAA,kEAAAD,EAAA,MAEJE,YAAaT,EAAG,EAAKU,SAFjB,OAGH,OADbC,EAFgB,QAGdC,QACN,EAAKT,SAAS,CACZL,SAAUa,EAAIE,OALI,uCAQrB,S,EAMPC,UAAY,SAACC,GACX,EAAKC,MAAMC,QAAQC,QAAQ,CAAEC,SAAU,YAAavB,MAAO,CAAEwB,GAAIL,EAAKM,UAAWC,KAAMP,EAAKQ,kB,EAI9FC,WAAa,WAGX,OAFqB,EAAK5B,MAAlBE,SAEQ2B,KAAI,SAAAV,GAAI,OACtB,wBAAIW,QAAS,kBAAM,EAAKZ,UAAUC,IAAOY,IAAKZ,EAAKM,UAAWO,UAAWC,IAAOC,KAC7Ef,EAAKQ,mB,uLAzCcQ,e,gBAAhBC,E,EAAAA,MACRC,KAAKvB,OAASsB,E,gFA6CL,IACDf,EAAYgB,KAAKjB,MAAjBC,QACApB,EAAcoC,KAAKrC,MAAnBC,UAER,OACE,yBAAK+B,UAAWC,IAAOK,MAErB,uBACEC,YAAY,mDACZH,MAAOnC,EACPuC,SAAUH,KAAKlC,cACfsC,kBAAkB,EAClBC,SAAU,kBAAMrB,EAAQC,QAAQ,gBAIlC,wBAAIU,UAAWC,IAAOU,MAAON,KAAKT,mB,GAxENgB","file":"static/js/16.78eb073f.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Search_root__1RO5f\",\"list\":\"Search_list__2aU3H\",\"noHistory\":\"Search_noHistory__1jsXM\",\"tips\":\"Search_tips__1_3KG\",\"tip\":\"Search_tip__V0T8K\"};","import React, { Component } from 'react'\r\n\r\nimport { SearchBar } from 'antd-mobile'\r\n\r\nimport { getCurrCity } from '../../../utils'\r\n\r\nimport styles from './index.module.css'\r\nimport { getCommunity } from '../../../utils/api/city'\r\n\r\nexport default class Search extends Component {\r\n\r\n  state = {\r\n    // 搜索框的值\r\n    searchTxt: '',\r\n    tipsList: []\r\n  }\r\n\r\n  async componentDidMount () {\r\n    // 获取城市ID\r\n    const { value } = await getCurrCity()\r\n    this.cityId = value\r\n  }\r\n\r\n  // 搜索小区\r\n  handlerSearch = (v) => {\r\n    v = v.trim()\r\n    if (v.length === 0) {\r\n      return this.setState({\r\n        searchTxt: '',\r\n        tipsList: []\r\n      })\r\n    }\r\n    this.setState({\r\n      searchTxt: v\r\n    }, () => {\r\n      this.timer && clearTimeout(this.timer)\r\n      this.timer = setTimeout(async () => {\r\n        // 获取小区列表\r\n        const res = await getCommunity(v, this.cityId)\r\n        if (res.status === 200) {\r\n          this.setState({\r\n            tipsList: res.data\r\n          })\r\n        }\r\n      }, 600)\r\n    })\r\n\r\n  }\r\n\r\n  // 选择小区回传\r\n  selectCom = (item) => {\r\n    this.props.history.replace({ pathname: '/rent/add', state: { id: item.community, name: item.communityName } })\r\n  }\r\n\r\n  // 渲染搜索结果列表\r\n  renderTips = () => {\r\n    const { tipsList } = this.state\r\n\r\n    return tipsList.map(item => (\r\n      <li onClick={() => this.selectCom(item)} key={item.community} className={styles.tip}>\r\n        {item.communityName}\r\n      </li>\r\n    ))\r\n  }\r\n\r\n  render () {\r\n    const { history } = this.props\r\n    const { searchTxt } = this.state\r\n\r\n    return (\r\n      <div className={styles.root}>\r\n        {/* 搜索框 */}\r\n        <SearchBar\r\n          placeholder=\"请输入小区或地址\"\r\n          value={searchTxt}\r\n          onChange={this.handlerSearch}\r\n          showCancelButton={true}\r\n          onCancel={() => history.replace('/rent/add')}\r\n        />\r\n\r\n        {/* 搜索提示列表 */}\r\n        <ul className={styles.tips}>{this.renderTips()}</ul>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"],"sourceRoot":""}